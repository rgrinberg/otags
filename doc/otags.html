<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML><HEAD><TITLE>Man page of OTAGS</TITLE>
</HEAD><BODY>
<H1>OTAGS</H1>
Section: User Manuals (1)<BR>Updated: August 2010<BR><A HREF="#index">Index</A>
<HR>

<A NAME="lbAB">&nbsp;</A>
<H2>NAME</H2>

otags - generate tags files for emacs and vi/vim from OCaml sources
<A NAME="lbAC">&nbsp;</A>
<H2>SYNOPSIS</H2>

<B>otags</B>

[<I>STATIC-OPTION</I>] ... [<I>FILE</I>] ... [<I>DYNAMIC-OPTION</I>] ... [<I>FILE</I>] ...
<A NAME="lbAD">&nbsp;</A>
<H2>DESCRIPTION</H2>


<B>otags</B>

generates
<I>TAGS</I>

files for 
<B>emacs</B>

and
<I>tags</I>

files for
<B>vi</B>/<B>vim</B>

to give these editors the ability to directly jump to function
and value definitions (use 
<B>M-.</B>

in Emacs and
<B>^]</B>

in vi[m] with the cursor on the symbol).

<P>

<B>otags</B>

uses
<B>camlp4</B>

for parsing. This is more precise than regular expression based
tagging. On the downside, 
<B>otags</B>

can only tag syntactically correct files. Furthermore,
<B>otags</B>

is 
<B>OCaml</B>

version specific: Sources to be compiled with 
<B>OCaml </B>

version 
<I>X.Y</I>

can, in general, only be tagged with 
<B>otags</B>

version
<I>X.Y</I>.


<P>

<B>otags</B>

can tag all files that
<B>camlp4</B>

can parse. Internally
<B>otags</B>

keeps a 
<B>current parser list</B>

that can be modified with the options
<B>-pc</B>

(clear list), 
<B>-pa</B>

(add to list), and
<B>-pr </B>

(reset to default).
The default value of the
<B>current parser list</B>

corresponds to standard
<B>OCaml</B>

syntax (containing the parsers
<B>r</B>

and
<B>o</B>,

see STANDARD CAMLP4 PARSING EXTENSIONS below).
Each source file is parsed with a
<B>camlp4</B>

parser into which all parsing extensions from the 
<B>current parser list</B>

have been loaded. The
<B>camlp4</B>

standard parsers are linked into
<B>otags</B>

and if the 
<B>current parser list</B>

contains only such parsers then the parsing module is build
internally. Otherwise an external
<B>camlp4</B>

process is started.

<P>

<B>otags</B>

tags all toplevel items in structures and signatures, including
infix operators and nested modules and signatures. It also tags
instance variables and methods in classes and class-types.
Filenames 
<B>FILE</B>

on the command line are parsed as interfaces if they have a 
<B>.mli</B>

suffix and as implementations if they have a
<B>.ml</B>

suffix. (See also the dynamic options 
<B>-intf</B>

and
<B>-impl</B>.)


<P>

<B>otags</B>

can tag all files in a directory tree (if option
<B>-r</B>

is given). Files that are generated by
<B>ocamllex</B>

or
<B>ocamlyacc</B>

or that require preprocessing with the 
<B>camlp4 macro</B>

parser must, however, be tagged in the same directory where these
tools have been run. This is because the line directives that
<B>ocamllex</B>

and
<B>ocamlyacc</B>

put into generated files are relative to the current working
directory of the generating process. For the
<B>camlp4 macro</B>

parser an 
<B>INCLUDE</B>

directive may be resolved relative to the current working
directory of the
<B>camlp4</B>

process. Therefore, if you tag such files from a different
directory you will get an error message. 

<P>

When tagging whole directory trees recursively, one can specify
exceptions from the
<B>current parser list</B>

in a parser hints file, see option
<B>-parser-hints</B>

and PARSING HINTS FILES below.

<P>

Tag files can contain absolute and/or relative file names. 
<B>Otags</B>

uses the file names from the command line for the tags file.
Specifying relative file names on the command line will therefore
give you a tag file with relative file names. Obviously, a tag
file with relative file names will only work if it is located in
the directory where
<B>otags</B>

was started. 
<B>Otags </B>

supports writing a tags file with relative file names in a parent
directory via option
<I>-add-path</I>,

see EXAMPLES below.





<A NAME="lbAE">&nbsp;</A>
<H2>STATIC OPTIONS</H2>

Static options take effect on the whole program run, regardless
of their position in the command line.

<DL COMPACT>
<DT>-r<DD>
Descend into directories. With this option, if one of the 
<I>FILE</I>

arguments is a directory 
<B>otags</B>

will recursively tag all files in this whole directory tree.

<DT>-o file<DD>
Write tags to
<I>file</I>.

The default is
<I>TAGS</I>

(for
<B>emacs</B>)

and 
<I>tags</I>

for 
<B>vi</B>

(if the 
<B>-vi</B>

option is given) in the current directory. If
<I>file</I>

is a dash (
<I>-</I>

) the tags are written to standard output.

<DT>-a<DD>
Append to an existing TAGS file (does only work for emacs TAGS files).

<DT>-vi<DD>
Generate tags for 
<B>vi</B>

and change the default output file into
<I>tags</I>.


<DT>-I dir<DD>
Add directory dir to the 
<B>camlp4</B>

search path for object files for
external
<B>camlp4</B>

parsing calls.

<DT>-add-path path<DD>
Add
<I>path</I>

at the front of every relative file name in the tags file.
Useful when you want to put the tags file in a parent directory.

<DT>-parser-hints file<DD>
Apply the parser hints in the specified file. Whenever
<B>otags</B>

tags a file that appears in a parser hints file, it uses the
parsers specified there instead of the
<B>current parser list</B>,

see PARSING HINTS FILES below.

<DT>-version<DD>
Print version and exit.

<DT>-v<DD>
Verbose. Print file names as they are parsed and the command
lines for externally started 
<B>camlp4</B>

parsing processes (if any). If
<B>-v</B>

is the first command line argument backtraces for exceptions are
enabled and printed if an exception escapes and terminates 
<B>otags</B>

(which is considered as a bug about which I would appreciate a
bug report).

<DT>-q<DD>
Be quiet.

<DT>-help<DD>
Print the option list.

<DT>--help<DD>
Alias for
<B>-help</B>






</DL>
<A NAME="lbAF">&nbsp;</A>
<H2>DYNAMIC OPTIONS</H2>

Dynamic options do only affect arguments that follow them on the
command line. 

<DL COMPACT>
<DT>-intf FILE<DD>
Parse and tag 
<B>FILE</B>

as an interface.

<DT>-impl FILE<DD>
Parse and tag
<B>FILE</B>

as implementation.

<DT>-pc<DD>
Clear the 
<B>current parser list</B>.


<DT>-pa parser<DD>
Add 
<I>parser</I>

to the 
<B>current parser list</B>. 

If 
<I>parser</I>

is not one of the
standard parsers that are distributed with 
<B>camlp4</B>

then the following file(s) are parsed in separate 
<B>camlp4</B>

process(es). 
<I>parser</I>

must be accepted by
<B>camlp4 -parser</B>,

that is, it must be a standard camlp4 parser name or a bytecode file
<I></I>(<I>.cmo</I>) or library (<I>.cma</I>).


<DT>-pr<DD>
Reset the 
<B>current parser list</B>

to its default value (parse standard 
<B>OCaml</B>

without extensions).

<DT>-pp<DD>
Print the 
<B>current parser list</B>.


<DT>-extern<DD>
Force
<B>otags</B>

to parse all the following files with an external
<B>camlp4</B>

process.

<DT>-intern<DD>
Switch back to (default) internal parsing. 





</DL>
<A NAME="lbAG">&nbsp;</A>
<H2>PARSING HINTS FILES</H2>

Parsing hints files are simple text files that specify parsers
for certain files. This is useful when tagging recursively with
option 
<B>-r</B>.

Here is an example for some files from the
<B>OCaml</B>

distribution:
<P>


<PRE>
oq:
        camlp4/examples/parse_files.ml
o rq g:
        camlp4/examples/macros.ml
        camlp4/examples/arith.ml
rf debug:
        camlp4/Camlp4Bin.ml
        camlp4/mkcamlp4.ml
        camlp4/camlp4prof.ml
        camlp4/camlp4prof.mli
</PRE>


<P>


<P>

The format of parser hints files is as follows. Empty lines and
lines starting with ``#'' are ignored. A parser hints file
consists of an arbitrary number of sections. Each section starts
with a colon terminated line that specifies the parser to use
with a space separated list of parser names (like those accepted
by option 
<B>-pa</B>). 

The remainder of the section contains file names, one per line.
Leading and trailing white space is ignored.





<A NAME="lbAH">&nbsp;</A>
<H2>EXAMPLES</H2>


<B>Tag some files in the original and some in the revised syntax:</B>

<P>

<DL COMPACT><DT><DD>
<B>otags </B>

original.ml 
<B>-pc -pa r</B>

revised.ml
<B>-pr</B>

original.ml
</DL>

<P>

The
<B>-pc</B>

is necessary because, for 
<B>camlp4</B>,

the original 
<B>OCaml</B>

syntax is an extension of the revised syntax. Therefore, the
default 
<B>current parser list</B>

contains the parser 
<B>r</B>

already and adding 
<B>r</B>

would not change the 
<B>current parser list</B>.

<P>


<B>Tag files with quotations</B>

(original host syntax and revised quotation syntax):
<P>

<DL COMPACT><DT><DD>
<B>otags -pa rq </B>

qotation.ml
</DL>

<P>


<B>Tag files that use the sexplib extension:</B>

<P>

<DL COMPACT><DT><DD>
<B>otags -I </B>

<I>/usr/lib/ocaml/type-conv </I>

<B>-I </B>

<I>/usr/lib/ocaml/sexplib </I>

<B>-pa</B>

<I>pa_type_conv.cmo</I>

<B>-pa</B>

<I>pa_sexp_conv.cmo</I>

use_sexp.ml
</DL>

<P>

The
<B>-I</B>

options specify the directories where 
<I>pa_type_conv.cmo </I>

and 
<I>pa_sexp_conv.cmo</I>

are located on the system.

<P>

<B>Tag files in a subdirectory keeping the tags file in parent directory</B>

<P>

<DL COMPACT><DT><DD>
cd 
<I>subdir</I>;

<B>otags </B>

-o 
<I>../TAGS</I>

-add-path
<I>subdir</I> ...

</DL>

<P>

This complicated procedure is only necessary if there are files inside
<I>subdir </I>

with line directives containing relative file names (for
instance, generated by 
<B>ocamllex</B>

or
<B>ocamlyacc</B>

running inside 
<I>subdir</I>) 

and when there are other sudirectories whose material should be
added to 
<I>../TAGS</I>.

If there are no files with relative line directives one can
simply use 
<B></B><B>otags</B> -r 

in the directory containing 
<I>subdir</I>.

If there are no other subdirectories one could put the tags file
into
<I>subdir</I>

without using -o or -add-path.





<A NAME="lbAI">&nbsp;</A>
<H2>STANDARD CAMLP4 PARSING EXTENSIONS</H2>

There is currently no documentation on the names and aliases that
refer to standard
<B>camlp4</B>

parsing modules. Also the dependencies among those modules is
mostly undocumented. The only source for information is the file
<I>camlp4/Camlp4Bin.ml</I>

in the 
<B>OCaml</B>

distribution.
<P>

The following list describes the identifiers that
<B>camlp4 -parser</B>

treats specifically. This is therefore the list of standard
<B>camlp4</B>

parsers. For these identifiers case is not significant (they are
piped through
<B>String.lowercase</B>

before matching). The dependencies listed here are treated
auto-magically by
<B>camlp4</B>

and 
<B>otags</B>. 


<DL COMPACT>
<DT><B>r</B>, <B>ocamlr</B>, <B>ocamlrevised</B>, <B>pa_r.cmo</B>, <B>camlp4ocamlrevisedparser.cmo</B><DD>
Revised syntax without stream parsers.

<DT><B>rr</B>, <B>reloaded</B>, <B>ocamlreloaded</B>, <B>camlp4ocamlreloadedparser.cmo</B><DD>
Variant of the revised syntax (usage unknown).

<DT><B>o</B>, <B>ocaml</B>, <B>pa_o.cmo</B>, <B>camlp4ocamlparser.cmo</B><DD>
Original syntax without stream parsers. Depends on parser
<B>r</B>.


<DT><B>rp</B>, <B>rparser</B>, <B>pa_rp.cmo</B>, <B>camlp4ocamlrevisedparserparser.cmo</B><DD>
Revised syntax with stream parsers. (See bug #5134 for OCaml
3.12.0 and earlier.)
Depends on parser 
<B>r</B>.


<DT><B>op</B>, <B>parser</B>, <B>pa_op.cmo</B>, <B>camlp4ocamlparserparser.cmo</B><DD>
Original syntax with stream parsers. Depends on parser
<B>r</B>, <B>o</B>, <B>rp</B>


<DT><B>g</B>, <B>grammar</B>, <B>pa_extend.cmo</B>, <B>pa_extend_m.cmo</B>, <B>camlp4grammarparser.cmo</B><DD>
Grammar extensions.

<DT><B>m</B>, <B>macro</B>, <B>pa_macro.cmo</B>, <B>camlp4macroparser.cmo</B><DD>
Macros and conditionals.

<DT><B>q</B>, <B>camlp4quotationexpander.cmo</B><DD>
Reflective Quotations. This parsing extension takes the current
host syntax and adds quotation expanders using that current
syntax such that the resulting grammar is reflective: Changing
the host syntax afterwards does also affect the quotation syntax.
Depends on module 
<B>Camlp4QuotationCommon</B>

(common quotation infrastructure).

<DT><B>rq</B>, <B>q_mlast.cmo</B>, <B>camlp4ocamlrevisedquotationexpander.cmo</B><DD>
Revised Quotations. Adds quotations in the revised syntax. Host
and quotation parsing remain independent. Depends on module
<B>Camlp4QuotationCommon</B>

(common quotation infrastructure).

<DT><B>oq</B>, <B>camlp4ocamloriginalquotationexpander.cmo</B><DD>
Original OCaml with original quotations. Loads original OCaml
(without stream parsers) as host syntax and as quotation syntax.
Host and quotation syntax are independent (not reflective).
Depends on parser
<B>ocamlr</B>, <B>ocaml</B> and module <B>Camlp4QuotationCommon</B>


<DT><B>rf</B><DD>
Full revised. Sets up revised syntax with stream parsers, grammar
extensions, list comprehensions and macros and adds reflective
quotations. Depends on parsers/modules
<B>r</B>, <B>rp</B>, <B>Camlp4QuotationCommon</B>, <B>q</B>, <B>g</B>, <B>comp</B>, <B>m</B>.


<DT><B>of</B><DD>
Original full. Sets up original OCaml with stream parsers,
grammar extensions, list comprehensions and macros and adds
reflective quotations (i.e., quotations are in original syntax).
(See bug #5129 for OCaml 3.12.0 and earlier.)
Depends on parsers/modules
<B>r</B>, <B>o</B>, <B>rp</B>, <B>op</B>, <B>Camlp4QuotationCommon</B>, <B>q</B>, <B>g</B>, <B>comp</B> and <B>m</B>.


<DT><B>comp</B>, <B>camlp4listcomprehension.cmo</B><DD>
List comprehensions.

<DT><B>debug</B>, <B>camlp4debugparser</B>, <B>camlp4debugparser.cmo</B><DD>
Debugging statements 
<I>debug</I>

and
<I>camlp4_debug</I>.

The expansion of those statements depends on the value of the
environment variable
<B>STATIC_CAMLP4_DEBUG</B>

such that also the produced tag entries might depend on this variable.





</DL>
<A NAME="lbAJ">&nbsp;</A>
<H2>DIAGNOSTICS</H2>


Parse errors are reported with normal
<B>camlp4</B>

error messages. No tags are generated for files that produce
errors. Tagging continues with the next file, in this case. 
<P>


The error &quot;Original source not available&quot; is reported if the file
to which a line directive refers cannot be found. This may happen
if 
<B>otags</B>

is started in a different directory than the program that
generated the faulting file.
<P>


<B>Otags</B>

exists with &quot;Parser list empty for ...&quot; when attempting
to process a file with an empty
<B>current parser list</B>. 

This happens when no 
<B>-pa</B>

option follows
<B>-pc</B>.

<P>


<B>Otags</B>

prints &quot;Toplevel directive found in ... Skip file.&quot; for files
containing toplevel directives. The problem is that the location
information in the abstract syntax tree is incorrect after
toplevel directives, see bug #5127.
<P>


Escaping exceptions and assertions that terminate 
<B>otags</B>

are considered as bugs. If they occur, please use option
<B>-v</B>

as 
<B>first</B>

command line switch to obtain an exception backtrace and submit this
with all relevant information as bug report.





<A NAME="lbAK">&nbsp;</A>
<H2>EXIT STATUS</H2>

<DL COMPACT>
<DT>0<DD>
everything went OK
<DT>1<DD>
a parse error or some other error occurred and 
<B>otags</B>

skipped the affected file
<DT>2<DD>
a fatal error caused 
<B>otags </B>

to abort
<DT>3<DD>
some bug caused a crash, from which 
<B>otags</B>

could only marginally recover





</DL>
<A NAME="lbAL">&nbsp;</A>
<H2>BUGS</H2>


<B>otags</B>

dies with a parse error on open!, which was introduced in
<B>OCaml</B>

version 4.01.0, but forgotten in
<B>camlp4</B>,

see bug #6175. For the same reason,
<B>otags</B>

4.01.1 is likely to cause strange problems when used with an
<B>OCaml</B>

version that fixes #6175.





<A NAME="lbAM">&nbsp;</A>
<H2>MISSING FEATURES</H2>

Appending to vi tags files requires to reread the existing tags
file, because vi tags files are sorted.
<P>


Incompatible
<B>camlp4</B>

syntax trees (from external 
<B>camlp4</B>

parsing processes) are detected with magic numbers. However, an
incompatible 
<B>camlp4</B>

will likely die when it tries to load the 
<B>otags</B>

specific
<B>camlp4</B>

printer. Such fatal dynamic loader errors are treated like
parsing errors, because 
<B>camlp4</B>

produces the same exit status in both cases.





<A NAME="lbAN">&nbsp;</A>
<H2>CREDITS</H2>

Cuihtlauac Alvarado and Jean-Francois Monin were the first to
exploit
<B>camlp4</B>

for tagging 
<B>OCaml</B>

files. This version is a complete rewrite,
based on the new
<B>camlp4</B>

from 
<B>OCaml</B>

version 3.10 and onwards.





<A NAME="lbAO">&nbsp;</A>
<H2>AUTHOR</H2>

Hendrik Tews &lt;otags at askra.de&gt;





<A NAME="lbAP">&nbsp;</A>
<H2>SEE ALSO</H2>

<B><A HREF="http://www.linuxmanpages.com/man1/etags.1.php">etags</A></B>(1),

<B><A HREF="http://www.linuxmanpages.com/man1/ctags.1.php">ctags</A></B>(1)









<P>

<HR>
<A NAME="index">&nbsp;</A><H2>Index</H2>
<DL>
<DT><A HREF="#lbAB">NAME</A><DD>
<DT><A HREF="#lbAC">SYNOPSIS</A><DD>
<DT><A HREF="#lbAD">DESCRIPTION</A><DD>
<DT><A HREF="#lbAE">STATIC OPTIONS</A><DD>
<DT><A HREF="#lbAF">DYNAMIC OPTIONS</A><DD>
<DT><A HREF="#lbAG">PARSING HINTS FILES</A><DD>
<DT><A HREF="#lbAH">EXAMPLES</A><DD>
<DT><A HREF="#lbAI">STANDARD CAMLP4 PARSING EXTENSIONS</A><DD>
<DT><A HREF="#lbAJ">DIAGNOSTICS</A><DD>
<DT><A HREF="#lbAK">EXIT STATUS</A><DD>
<DT><A HREF="#lbAL">BUGS</A><DD>
<DT><A HREF="#lbAM">MISSING FEATURES</A><DD>
<DT><A HREF="#lbAN">CREDITS</A><DD>
<DT><A HREF="#lbAO">AUTHOR</A><DD>
<DT><A HREF="#lbAP">SEE ALSO</A><DD>
</DL>
<HR>
This document was created by
<A HREF="http://www.nongnu.org/man2html/">man2html</A>,
using the manual pages.<BR>
Time: 08:41:36 GMT, September 25, 2013
</BODY>
</HTML>
